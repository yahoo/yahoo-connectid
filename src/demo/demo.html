<!-- Copyright Yahoo, Licensed under the terms of the Apache 2.0 license. See LICENSE file in project root for terms. -->

<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title>Yahoo ConnectID JS Demo Page</title>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <style>
        html, body {
            overflow: hidden;
            height: 100%;
            width: 100%;
            margin: 0;
            padding: 0;
        }

        th {
            text-align: start;
            font-size: 18px;
        }

        th, td {
            border-width: 0 0 1px 0;
            border-style: solid;
            border-color: black;
            padding: 5px 10px 5px 0;
        }

        h1 {
            background: #000;
            color: #fff;
            padding: 10px;
            margin: 0;
        }

        .content {
            padding: 20px 40px;
        }

        .param {
            margin: 3px 0 3px 30px;
        }

        .param-name {
            width: 150px;
            display: inline-block;
        }

    </style>
</head>
<body>
<div id="root"></div>
<h1>Yahoo ConnectID JS Module Demo</h1>

<div class="content">
    <div>connectid.getIds({</div>
    <div class="param">
        <span class="param-name">pixelId:</span>
        <input id="pixelId"/>
    </div>
    <div class="param">
        <span class="param-name">email:</span>
        <input id="email"/>
    </div>
    <div class="param">
        <span class="param-name">puid:</span>
        <input id="puid"/>
    </div>
    <div class="param">
        <span class="param-name">gdpr:</span>
        <select id="gdpr" value="0">
            <option value="0">false</option>
            <option value="1">true</option>
        </select>
    </div>
    <div class="param">
        <span class="param-name">gdprConsent:</span>
        <input id="gdprConsent"/>
    </div>
    <div class="param">
        <span class="param-name">usPrivacy:</span>
        <input id="usPrivacy"/>
    </div>

    <div>}, response => {</div>
    <div class="param">
        <span>console.log(response);</span>
        <div id="getIdsResponse"></div>
    </div>
    <div>})</div>

    <button id="execute">Execute</button>
    <button id="reset">Reset</button>

    <h3>All Local Storage Data</h3>
    <pre id="localStorageData"></pre>

    <div id="connectid-optout-link" style="position: absolute; bottom: 16px; right: 16px;"></div>
    <script>
      (function () {
        var optOutLabel = 'Opt-out of connectID';
        var optInLabel = 'Opt-in to connectID';
        function setOptedOut(optedOut) {
          try {
            window.localStorage.setItem('connectIdOptOut', optedOut ? '1' : '0');
          } catch (e) {}
          render();
        }
        function render() {
          var isOptedOut = false;
          try {
            isOptedOut = window.localStorage.getItem('connectIdOptOut') === '1';
          } catch (e) {}
          var a = document.createElement('a');
          a.href = 'javascript:';
          a.title = isOptedOut ? optInLabel : optOutLabel;
          a.appendChild(document.createTextNode(a.title));
          a.addEventListener('click', function eventHandler() {setOptedOut(!isOptedOut)});
          var el = document.getElementById("connectid-optout-link");
          el.firstChild && el.removeChild(el.firstChild);
          el.appendChild(a);
        }
        render();
      })();
    </script>
</div>

</body>
</html>
